<%= form_with model: credit_pack, url: credit_pack.new_record? ? create_credit_pack_admin_shop_management_index_path : update_credit_pack_admin_shop_management_path(credit_pack), method: credit_pack.new_record? ? :post : :patch, class: "space-y-6" do |f| %>
  <% if credit_pack.errors.any? %>
    <div class="p-4 rounded-xl bg-red-500/10 border border-red-500/20">
      <div class="flex items-start gap-3">
        <i class="fa-solid fa-exclamation-circle text-red-400 mt-0.5"></i>
        <div>
          <p class="font-medium text-red-300"><%= pluralize(credit_pack.errors.count, "erreur") %></p>
          <ul class="mt-2 text-sm text-red-300/70 list-disc list-inside">
            <% credit_pack.errors.full_messages.each do |msg| %>
              <li><%= msg %></li>
            <% end %>
          </ul>
        </div>
      </div>
    </div>
  <% end %>

  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    <div class="bg-neutral-900 rounded-xl p-6 border border-neutral-800">
      <h3 class="font-semibold text-white mb-4 flex items-center gap-2">
        <i class="fa-solid fa-euro-sign text-emerald-400"></i>
        Tarification
      </h3>
      
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-neutral-300 mb-2">Montant (€) *</label>
          <%= f.number_field :amount, required: true, min: 1, placeholder: "500", class: "w-full px-4 py-3 bg-neutral-800 border border-neutral-700 rounded-lg text-white placeholder-neutral-500 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent" %>
          <p class="text-xs text-neutral-500 mt-1">Le prix que le client paie</p>
        </div>
        
        <div>
          <label class="block text-sm font-medium text-neutral-300 mb-2">Bonus (%) *</label>
          <%= f.number_field :bonus_percentage, required: true, min: 0, max: 100, placeholder: "5", class: "w-full px-4 py-3 bg-neutral-800 border border-neutral-700 rounded-lg text-white placeholder-neutral-500 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent" %>
          <p class="text-xs text-neutral-500 mt-1">Pourcentage de bonus offert</p>
        </div>
        
        <div>
          <label class="block text-sm font-medium text-neutral-300 mb-2">Label personnalisé</label>
          <%= f.text_field :label, placeholder: "Pack Premium", class: "w-full px-4 py-3 bg-neutral-800 border border-neutral-700 rounded-lg text-white placeholder-neutral-500 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent" %>
          <p class="text-xs text-neutral-500 mt-1">Optionnel - Sinon "Pack X€"</p>
        </div>
        
        <div>
          <label class="block text-sm font-medium text-neutral-300 mb-2">Position</label>
          <%= f.number_field :position, min: 0, placeholder: "1", class: "w-full px-4 py-3 bg-neutral-800 border border-neutral-700 rounded-lg text-white placeholder-neutral-500 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent" %>
        </div>
      </div>
    </div>

    <div class="space-y-6">
      <div class="bg-neutral-900 rounded-xl p-6 border border-neutral-800">
        <h3 class="font-semibold text-white mb-4 flex items-center gap-2">
          <i class="fa-solid fa-star text-amber-400"></i>
          Mise en avant
        </h3>
        
        <div class="space-y-3">
          <label class="flex items-center gap-3 p-4 rounded-lg bg-neutral-800 border border-neutral-700 cursor-pointer hover:border-neutral-600 transition-colors">
            <%= f.check_box :is_popular, class: "w-5 h-5 rounded bg-neutral-700 border-neutral-600 text-amber-500 focus:ring-amber-500 focus:ring-offset-neutral-900" %>
            <div>
              <p class="font-medium text-white">Populaire</p>
              <p class="text-xs text-neutral-500">Badge "POPULAIRE" affiché</p>
            </div>
          </label>
          
          <label class="flex items-center gap-3 p-4 rounded-lg bg-neutral-800 border border-neutral-700 cursor-pointer hover:border-neutral-600 transition-colors">
            <%= f.check_box :is_best, class: "w-5 h-5 rounded bg-neutral-700 border-neutral-600 text-violet-500 focus:ring-violet-500 focus:ring-offset-neutral-900" %>
            <div>
              <p class="font-medium text-white">Meilleur choix</p>
              <p class="text-xs text-neutral-500">Badge "MEILLEUR" affiché</p>
            </div>
          </label>
        </div>
      </div>

      <div class="bg-neutral-900 rounded-xl p-6 border border-neutral-800">
        <h3 class="font-semibold text-white mb-4 flex items-center gap-2">
          <i class="fa-solid fa-toggle-on text-green-400"></i>
          Statut
        </h3>
        
        <label class="flex items-center gap-3 p-4 rounded-lg bg-neutral-800 border border-neutral-700 cursor-pointer hover:border-neutral-600 transition-colors">
          <%= f.check_box :active, class: "w-5 h-5 rounded bg-neutral-700 border-neutral-600 text-green-500 focus:ring-green-500 focus:ring-offset-neutral-900" %>
          <div>
            <p class="font-medium text-white">Actif</p>
            <p class="text-xs text-neutral-500">Visible dans la boutique</p>
          </div>
        </label>
      </div>

      <% if credit_pack.persisted? || credit_pack.amount.present? %>
        <div class="bg-gradient-to-br from-emerald-950/50 to-teal-950/30 rounded-xl p-6 border border-emerald-500/30">
          <h3 class="font-semibold text-white mb-3">Aperçu</h3>
          <div class="text-center">
            <p class="text-3xl font-bold text-white"><%= credit_pack.amount || 0 %>€</p>
            <p class="text-sm text-emerald-400 mt-1">+<%= credit_pack.bonus_percentage || 0 %>% bonus</p>
            <div class="mt-3 p-3 rounded-lg bg-emerald-500/10">
              <p class="text-xs text-neutral-400">Total reçu</p>
              <p class="text-xl font-bold text-emerald-400"><%= credit_pack.total_credits rescue 0 %>€</p>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </div>

  <div class="flex items-center gap-4">
    <%= f.submit credit_pack.new_record? ? "Créer le Pack" : "Enregistrer", class: "flex items-center gap-2 rounded-lg bg-emerald-600 px-6 py-3 text-sm font-medium text-white shadow-lg hover:bg-emerald-500 cursor-pointer" %>
    <%= link_to admin_shop_management_index_path(tab: 'credits'), class: "flex items-center gap-2 rounded-lg border border-neutral-700 bg-neutral-800 px-6 py-3 text-sm font-medium text-neutral-300 hover:bg-neutral-700 hover:text-white" do %>
      Annuler
    <% end %>
  </div>
<% end %>

